{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ferre\\\\OneDrive\\\\\\xC1rea de Trabalho\\\\CLB02-2020---Portal-Geoeste\\\\client\\\\src\\\\components\\\\Button\\\\DownloadFile.tsx\";\nimport axios from \"axios\";\nimport React, { useState } from \"react\";\nimport { DateTime } from \"luxon\";\nimport { useDownload } from \"../../hooks/useDownload\";\nimport { Button, ButtonState } from \"./Button\";\nimport { Alert, Container } from \"react-bootstrap\";\nimport { DownloadBtn } from \"./style\";\nimport { Navigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Download(args) {\n  var _s = $RefreshSig$();\n\n  var path = \"/api/Data/mapas/\" + String(args.id) + \"/download\";\n  if (args.downloadType === \"publication\") path = \"/api/Data/publications/download/\" + String(args.id);\n\n  const DownloadFile = () => {\n    _s();\n\n    const [buttonState, setButtonState] = useState(ButtonState.Primary);\n    const [showAlert, setShowAlert] = useState(false);\n\n    const preDownloading = () => setButtonState(ButtonState.Loading);\n\n    const postDownloading = () => setButtonState(ButtonState.Primary);\n\n    const onErrorDownloadFile = () => {\n      setButtonState(ButtonState.Primary);\n      setShowAlert(true);\n      setTimeout(() => {\n        setShowAlert(false);\n      }, 3000);\n    };\n\n    const getFileName = () => {\n      if (args.downloadType === \"publication\") return DateTime.local().toISODate() + \"-\" + String(args.title) + \".pdf\";\n      return DateTime.local().toISODate() + String(args.id) + \".zip\";\n    };\n\n    const downloadFile = () => {\n      return axios.get(path, {\n        responseType: \"blob\",\n        headers: {\n          authorization: \"Bearer \" + args.token // add authentication information as required by the backend APIs.\n\n        }\n      });\n    };\n\n    const {\n      ref,\n      url,\n      download,\n      name\n    } = useDownload({\n      apiDefinition: downloadFile,\n      preDownloading,\n      postDownloading,\n      onError: onErrorDownloadFile,\n      getFileName\n    });\n    return /*#__PURE__*/_jsxDEV(Container, {\n      className: \"mt-5\",\n      children: [/*#__PURE__*/_jsxDEV(Alert, {\n        variant: \"danger\",\n        show: showAlert,\n        children: /*#__PURE__*/_jsxDEV(Navigate, {\n          to: \"/login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(DownloadBtn, {\n        p: args.pos,\n        l: args.lef,\n        children: [/*#__PURE__*/_jsxDEV(\"a\", {\n          href: url,\n          download: name,\n          className: \"hidden\",\n          ref: ref\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            \"marginLeft\": \"32%\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            label: \"Download\",\n            buttonState: buttonState,\n            onClick: download\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 5\n    }, this);\n  };\n\n  _s(DownloadFile, \"3ND9IFmlV+NH1firqCg+IpSt5Ag=\", false, function () {\n    return [useDownload];\n  });\n\n  return /*#__PURE__*/_jsxDEV(DownloadFile, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 9\n  }, this);\n}\n\n_c = Download;\n;\nexport default Download;\n\nvar _c;\n\n$RefreshReg$(_c, \"Download\");","map":{"version":3,"names":["axios","React","useState","DateTime","useDownload","Button","ButtonState","Alert","Container","DownloadBtn","Navigate","Download","args","path","String","id","downloadType","DownloadFile","buttonState","setButtonState","Primary","showAlert","setShowAlert","preDownloading","Loading","postDownloading","onErrorDownloadFile","setTimeout","getFileName","local","toISODate","title","downloadFile","get","responseType","headers","authorization","token","ref","url","download","name","apiDefinition","onError","pos","lef"],"sources":["C:/Users/ferre/OneDrive/Área de Trabalho/CLB02-2020---Portal-Geoeste/client/src/components/Button/DownloadFile.tsx"],"sourcesContent":["import axios from \"axios\";\r\nimport React, { useState } from \"react\";\r\nimport { DateTime } from \"luxon\";\r\nimport { useDownload } from \"../../hooks/useDownload\";\r\nimport { Button, ButtonState } from \"./Button\";\r\nimport { Alert, Container } from \"react-bootstrap\";\r\nimport { DownloadBtn } from \"./style\";\r\nimport { Navigate } from \"react-router-dom\";\r\nimport { IDownloadProps } from \"../../interfaces\";\r\n\r\nfunction Download(args: IDownloadProps) {\r\n  var path = \"/api/Data/mapas/\"+ String(args.id) + \"/download\"\r\n  if(args.downloadType === \"publication\")\r\n    path = \"/api/Data/publications/download/\"+ String(args.id)\r\n  \r\n  const DownloadFile: React.FC = () => {\r\n  const [buttonState, setButtonState] = useState<ButtonState>(\r\n    ButtonState.Primary\r\n  );\r\n  const [showAlert, setShowAlert] = useState<boolean>(false);\r\n\r\n  const preDownloading = () => setButtonState(ButtonState.Loading);\r\n  const postDownloading = () => setButtonState(ButtonState.Primary);\r\n\r\n  const onErrorDownloadFile = () => {\r\n    setButtonState(ButtonState.Primary);\r\n    setShowAlert(true);\r\n    setTimeout(() => {\r\n      setShowAlert(false);\r\n    }, 3000);\r\n  };\r\n\r\n  const getFileName = () => {\r\n    if(args.downloadType === \"publication\")\r\n      return DateTime.local().toISODate() + \"-\" + String(args.title) + \".pdf\";\r\n    return DateTime.local().toISODate() + String(args.id) + \".zip\";\r\n  };\r\n\r\n  const downloadFile = () => {\r\n    \r\n    return axios.get(\r\n      path,\r\n      {\r\n        responseType: \"blob\",\r\n         \r\n        headers: {\r\n          authorization: \"Bearer \" + args.token, // add authentication information as required by the backend APIs.\r\n        }\r\n         \r\n      }\r\n    );\r\n  };\r\n\r\n  const { ref, url, download, name } = useDownload({\r\n    apiDefinition: downloadFile,\r\n    preDownloading,\r\n    postDownloading,\r\n    onError: onErrorDownloadFile,\r\n    getFileName,\r\n  });\r\n\r\n  return (\r\n    <Container className=\"mt-5\">\r\n      <Alert variant=\"danger\" show={showAlert}>\r\n        <Navigate to='/login'/>\r\n      </Alert>\r\n      <DownloadBtn p={args.pos} l={args.lef}>\r\n      <a href={url} download={name} className=\"hidden\" ref={ref}/>\r\n      <div style={{\"marginLeft\":\"32%\"}}>\r\n      <Button label=\"Download\" buttonState={buttonState} onClick={download}/>\r\n      </div>\r\n      </DownloadBtn>\r\n    </Container>\r\n  );\r\n}\r\nreturn (<DownloadFile/>)\r\n};\r\n\r\nexport default Download;\r\n"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,SAASC,QAAT,QAAyB,OAAzB;AACA,SAASC,WAAT,QAA4B,yBAA5B;AACA,SAASC,MAAT,EAAiBC,WAAjB,QAAoC,UAApC;AACA,SAASC,KAAT,EAAgBC,SAAhB,QAAiC,iBAAjC;AACA,SAASC,WAAT,QAA4B,SAA5B;AACA,SAASC,QAAT,QAAyB,kBAAzB;;;AAGA,SAASC,QAAT,CAAkBC,IAAlB,EAAwC;EAAA;;EACtC,IAAIC,IAAI,GAAG,qBAAoBC,MAAM,CAACF,IAAI,CAACG,EAAN,CAA1B,GAAsC,WAAjD;EACA,IAAGH,IAAI,CAACI,YAAL,KAAsB,aAAzB,EACEH,IAAI,GAAG,qCAAoCC,MAAM,CAACF,IAAI,CAACG,EAAN,CAAjD;;EAEF,MAAME,YAAsB,GAAG,MAAM;IAAA;;IACrC,MAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCjB,QAAQ,CAC5CI,WAAW,CAACc,OADgC,CAA9C;IAGA,MAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4BpB,QAAQ,CAAU,KAAV,CAA1C;;IAEA,MAAMqB,cAAc,GAAG,MAAMJ,cAAc,CAACb,WAAW,CAACkB,OAAb,CAA3C;;IACA,MAAMC,eAAe,GAAG,MAAMN,cAAc,CAACb,WAAW,CAACc,OAAb,CAA5C;;IAEA,MAAMM,mBAAmB,GAAG,MAAM;MAChCP,cAAc,CAACb,WAAW,CAACc,OAAb,CAAd;MACAE,YAAY,CAAC,IAAD,CAAZ;MACAK,UAAU,CAAC,MAAM;QACfL,YAAY,CAAC,KAAD,CAAZ;MACD,CAFS,EAEP,IAFO,CAAV;IAGD,CAND;;IAQA,MAAMM,WAAW,GAAG,MAAM;MACxB,IAAGhB,IAAI,CAACI,YAAL,KAAsB,aAAzB,EACE,OAAOb,QAAQ,CAAC0B,KAAT,GAAiBC,SAAjB,KAA+B,GAA/B,GAAqChB,MAAM,CAACF,IAAI,CAACmB,KAAN,CAA3C,GAA0D,MAAjE;MACF,OAAO5B,QAAQ,CAAC0B,KAAT,GAAiBC,SAAjB,KAA+BhB,MAAM,CAACF,IAAI,CAACG,EAAN,CAArC,GAAiD,MAAxD;IACD,CAJD;;IAMA,MAAMiB,YAAY,GAAG,MAAM;MAEzB,OAAOhC,KAAK,CAACiC,GAAN,CACLpB,IADK,EAEL;QACEqB,YAAY,EAAE,MADhB;QAGEC,OAAO,EAAE;UACPC,aAAa,EAAE,YAAYxB,IAAI,CAACyB,KADzB,CACgC;;QADhC;MAHX,CAFK,CAAP;IAWD,CAbD;;IAeA,MAAM;MAAEC,GAAF;MAAOC,GAAP;MAAYC,QAAZ;MAAsBC;IAAtB,IAA+BrC,WAAW,CAAC;MAC/CsC,aAAa,EAAEV,YADgC;MAE/CT,cAF+C;MAG/CE,eAH+C;MAI/CkB,OAAO,EAAEjB,mBAJsC;MAK/CE;IAL+C,CAAD,CAAhD;IAQA,oBACE,QAAC,SAAD;MAAW,SAAS,EAAC,MAArB;MAAA,wBACE,QAAC,KAAD;QAAO,OAAO,EAAC,QAAf;QAAwB,IAAI,EAAEP,SAA9B;QAAA,uBACE,QAAC,QAAD;UAAU,EAAE,EAAC;QAAb;UAAA;UAAA;UAAA;QAAA;MADF;QAAA;QAAA;QAAA;MAAA,QADF,eAIE,QAAC,WAAD;QAAa,CAAC,EAAET,IAAI,CAACgC,GAArB;QAA0B,CAAC,EAAEhC,IAAI,CAACiC,GAAlC;QAAA,wBACA;UAAG,IAAI,EAAEN,GAAT;UAAc,QAAQ,EAAEE,IAAxB;UAA8B,SAAS,EAAC,QAAxC;UAAiD,GAAG,EAAEH;QAAtD;UAAA;UAAA;UAAA;QAAA,QADA,eAEA;UAAK,KAAK,EAAE;YAAC,cAAa;UAAd,CAAZ;UAAA,uBACA,QAAC,MAAD;YAAQ,KAAK,EAAC,UAAd;YAAyB,WAAW,EAAEpB,WAAtC;YAAmD,OAAO,EAAEsB;UAA5D;YAAA;YAAA;YAAA;UAAA;QADA;UAAA;UAAA;UAAA;QAAA,QAFA;MAAA;QAAA;QAAA;QAAA;MAAA,QAJF;IAAA;MAAA;MAAA;MAAA;IAAA,QADF;EAaD,CA3DC;;EALsC,GAKhCvB,YALgC;IAAA,QA2CDb,WA3CC;EAAA;;EAiExC,oBAAQ,QAAC,YAAD;IAAA;IAAA;IAAA;EAAA,QAAR;AACC;;KAlEQO,Q;AAkER;AAED,eAAeA,QAAf"},"metadata":{},"sourceType":"module"}